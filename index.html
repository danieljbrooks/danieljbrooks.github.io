<!DOCTYPE html>
<html>
<body>

<!-- Include DTK cardlist -->
<script src="DTK_2.js"></script>

<!--Primary Javascript section--> 
<script>

//Define the card class
//function Card(name, castingcost1, castingcost2, cardtype, rarity, myranking){
//  this.name=name;
//  this.castingcost1=castingcost1;
//  this.castingcost2=castingcost2;
//  this.cardtype=cardtype;
//  this.rarity=rarity;
//  this.myranking=myranking;
//}
 
//Define the pack class
function Pack(card_list){
  this.pack_contents=[];
  
  //Define card contents
  var common=0;
  var uncommon=0;
  var rare=0;
  var mythic=0;
  
  //Determine number of cards in set
  var cards_in_set=card_list.length
  document.getElementById("debug2").innerHTML = cards_in_set;  //remove to test
  //document.getElementById("debug2").innerHTML = "updating debug 2";
  
  
  //add a common to start out the pack
  need_common=true;
  while(need_common){
    card_roll=Math.floor((Math.random() * cards_in_set));
    new_card = card_list[card_roll];
    if (new_card.rarity=="C"){
    	this.pack_contents.push(new_card);
        common=common+1;
        need_common=false;
    }
  }
  
  //figure out if mythic or rare
  mythic_roll=Math.floor((Math.random() * 121) + 1);
  if (mythic_roll>15){
    mythic=1;
  } else {
    rare=1;
  }
  
  //add cards without duplication
  var its=0; //prevent infinite loops
  while(this.pack_contents.length<15 && its<10000){
    its=its+1;
    
    //choose a random card in DTK
    var card_roll=Math.floor((Math.random() * cards_in_set));
    var new_card = card_list[card_roll];

    //Check if card in pack contents
    var card_in_pack=0;
    if (this.pack_contents.length>0){
      for (var i = 0; i < this.pack_contents.length; i++) {
        if ( new_card.name==this.pack_contents[i].name){
          card_in_pack=1;
        }
      }
    }
    
    //Determine card rarity and add new card to pack if possible
    rarity_nc=new_card.rarity
    document.getElementById("debug5").innerHTML = rarity_nc;
    if (card_in_pack<1){
      if (rarity_nc=="C" && common < 11){
      	this.pack_contents.push(card_list[card_roll]);
      	common=common+1;
      } else if (rarity_nc=="U" && uncommon < 3){
      	this.pack_contents.push(card_list[card_roll]);
      	uncommon=uncommon+1;
      } else if (rarity_nc=="R" && rare < 1){
      	this.pack_contents.push(card_list[card_roll]);
      	rare=rare+1;
      } else if (rarity_nc=="M" && mythic < 1){
      	this.pack_contents.push(card_list[card_roll]);
      	mythic=mythic+1;
      }
   }    
  }
}
</script>

<script>
function printPackBeta() {
    
    var pack1 = new Pack(DTK);
    
    //clear images
    document.getElementById("debug6").innerHTML = "";
    
    //for each card in the pack
    var sc="The cards in this pack are: ";
    for (var i = 0; i < pack1.pack_contents.length; i++) {
      sc=sc.concat(pack1.pack_contents[i].name);
      sc=sc.concat(" ");
      
      //Add images to debug6 section
      var img = document.createElement('img');
      img.src = "DTK/".concat(pack1.pack_contents[i].image)
      document.getElementById('debug6').appendChild(img)
      
    }
    sc=sc.concat(" .");
    
    //alert("Hello! I am an alert box!");
    var my_string = "this is my string"
    //alert("Pack Created")
    document.getElementById("debug").innerHTML = sc;
    
}
</script>

<script>
//generate a draft object


function Draft(set1, set2, set3, num_players){
  
  //Create an array of players
  this.players=[]
 
  //Add players
  for (i = 1; i < num_players; i++) {
    //Needs to be debugged
    var pack_i=new Pack(set1);
    var drafter_i= {pack:pack_i,collection:[]};
    this.players.push(drafter_i);
  }
}

//player has fields: {pack, collection}

function Print_collection(player_index){
  //create a new draft
  var cur_draft = new Draft(DTK, DTK, DTK, 8);
  
  //Define region to print to
  var div = document.getElementById("debug7");
  
  //Clear the region
  div.innerHTML = "";
  
  //Print each card in the pack
  pack_length=cur_draft.players[player_index].pack.pack_contents.length
  for (i = 0; i < pack_length; i++) {
    var cur_card = cur_draft.players[player_index].pack.pack_contents[i];
    div.innerHTML= div.innerHTML + cur_card.name + "       " + cur_card.myrating + "\n";
  }
}
</script>


<h1> Look, a button! Check back soon for the draft simulator!</h1>
<p><a href="https://www.pythonanywhere.com/gists/905201f664f09b8a3b11/code.py/ipython2/">Draft Simulator (Pre-Alpha)!</a></p>
<p>Interested? Contact danielbrooks20 at gmail dot com</p>

</script>

<button onclick="printPackBeta()" style="fontSize:xx-large;">Generate Pack</button>
<button onclick="Print_collection(0)" style="fontSize:xx-large;">Print Collection</button>
<p id="debug7"> </p>
<p id="debug6"> </p>
<p id="debug"> v76</p>
<p id="debug2"> </p>
<p id="debug3"> </p>
<p id="debug4"> </p>
<p id="debug5"> </p>

</body>
</html>
